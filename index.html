<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKC Landing Page</title>
    <!-- Anime.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'pkc-primary': '#667eea',
              'pkc-secondary': '#764ba2',
              'pkc-gold': '#ffd700'
            },
            animation: {
              'pulse-slow': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite'
            }
          }
        }
      }
    </script>
    <style>
      /* Status dot colors - using Tailwind utilities directly in HTML */
    </style>
</head>
<body class="min-h-screen flex items-center justify-center font-sans text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="max-w-4xl mx-auto px-8 py-16 text-center" data-anime="main-content">
      <p id="pkc-title-text" class="text-xl md:text-2xl font-semibold mb-4 opacity-0 translate-y-8" data-anime="env-title"></p>
      <h1 class="text-4xl md:text-5xl font-bold mb-4 opacity-0 translate-y-8" data-anime="title">PKC Landing Page</h1>
      <p class="text-xl md:text-2xl mb-12 opacity-0 translate-y-8" data-anime="subtitle">Static-first. Modular by design. Localâ€‘first ready.</p>
      <div class="flex flex-wrap gap-4 justify-center mb-16 opacity-0 translate-y-8" data-anime="buttons">
        <a href="pkc-docs-index.html" class="px-6 py-3 bg-white text-pkc-primary rounded-full border border-white/40 hover:bg-white/90 transition-colors font-medium">Browse Documentation</a>
        <a href="tic-tac-toe.html" class="px-6 py-3 rounded-full border border-white/40 text-white hover:bg-white/10 transition-colors font-medium">ðŸŽ® Tic-Tac-Toe P2P</a>
        <a href="js/modules/p2p-serverless/example.html" class="px-6 py-3 rounded-full border border-white/40 text-white hover:bg-white/10 transition-colors font-medium">ðŸ”— P2P Demo</a>
        <a href="pkc-viewer.html?doc=LaTeX-Test.md" class="px-6 py-3 rounded-full border border-white/40 text-white hover:bg-white/10 transition-colors font-medium">LaTeX Test</a>
        <a href="https://github.com/xlp0/LandingPage" target="_blank" rel="noopener" class="px-6 py-3 rounded-full border border-white/40 text-white hover:bg-white/10 transition-colors font-medium">GitHub</a>
        <a href="/js/modules/video-meeting/index.html" class="px-6 py-3 rounded-full border border-white/40 text-white hover:bg-white/10 transition-colors font-medium">ðŸŽ¥ Video Meeting P2P</a>
      </div>
    </div>
    
    <!-- P2P Status Panel -->
    <div id="p2p-panel" class="fixed left-4 bottom-4 w-72 max-h-[40vh] flex flex-col bg-black/25 border border-white/25 rounded-xl text-white backdrop-blur-md overflow-hidden z-50" aria-live="polite">
      <div class="px-3 py-2 border-b border-white/15 font-semibold flex justify-between items-center gap-2">
        <span>P2P</span>
        <div class="flex gap-2 text-xs">
          <span>Clients: <span id="client-count">0</span></span>
          <span>Peers: <span id="peer-count">0</span></span>
        </div>
      </div>
      <div class="px-3 py-2 overflow-auto text-sm">
        <div id="p2p-status" class="opacity-90">idle</div>
        <div id="p2p-messages" class="mt-2 max-h-52 overflow-y-auto whitespace-pre-wrap break-words break-all font-mono text-xs leading-snug space-y-1"></div>
      </div>
    </div>
    
    <!-- WebSocket Status Badge -->
    <div id="ws-status" class="fixed right-4 bottom-4 px-3 py-1.5 rounded-full text-xs font-semibold tracking-wide bg-white/15 border border-white/30 backdrop-blur-md inline-flex items-center gap-1.5 text-white z-50" aria-live="polite">
      <span class="w-2 h-2 rounded-full bg-gray-400" id="ws-dot"></span>
      <span>WS: idle</span>
    </div>
    
    <!-- Runtime environment watcher -->
    <script>
      async function updateEnvTitle() {
        try {
          // Try to fetch from API endpoint (now served from same port)
          const response = await fetch('/api/env', { cache: 'no-cache' });
          if (response.ok) {
            const env = await response.json();
            if (env.PKC_Title_Text) {
              const titleEl = document.getElementById('pkc-title-text');
              if (titleEl && titleEl.textContent !== env.PKC_Title_Text) {
                titleEl.textContent = env.PKC_Title_Text;
                console.log('[PKC] Title updated to:', env.PKC_Title_Text);
              }
            }
          }
        } catch (err) {
          // Fallback: try to load .env file directly (works in static server)
          try {
            const response = await fetch('.env', { cache: 'no-cache' });
            if (response.ok) {
              const data = await response.text();
              const lines = data.split('\n');
              for (const line of lines) {
                if (line.startsWith('PKC_Title_Text=')) {
                  const value = line.split('=')[1].trim();
                  const titleEl = document.getElementById('pkc-title-text');
                  if (titleEl && titleEl.textContent !== value) {
                    titleEl.textContent = value;
                    console.log('[PKC] Title updated to:', value);
                  }
                  break;
                }
              }
            }
          } catch (fallbackErr) {
            console.error('[PKC] Failed to load env from both sources:', err, fallbackErr);
          }
        }
      }

      // Initial load
      updateEnvTitle();

      // Poll for env changes every 2 seconds
      setInterval(updateEnvTitle, 2000);
    </script>
    
    <script type="module">
      import { PKC } from './js/pkc-core.js';
      
      // Anime.js Page Animations
      document.addEventListener('DOMContentLoaded', () => {
        // Page entrance animations
        const tl = anime.timeline({
          easing: 'easeOutExpo',
          duration: 800
        });
        
        tl.add({
          targets: '[data-anime="env-title"]',
          opacity: [0, 1],
          translateY: [32, 0],
          duration: 1000
        })
        .add({
          targets: '[data-anime="title"]',
          opacity: [0, 1],
          translateY: [32, 0],
          duration: 1000
        })
        .add({
          targets: '[data-anime="subtitle"]',
          opacity: [0, 1],
          translateY: [24, 0],
          duration: 800
        }, '-=600')
        .add({
          targets: '[data-anime="buttons"]',
          opacity: [0, 1],
          translateY: [16, 0],
          duration: 600
        }, '-=400');
        
        // Button hover animations
        const buttons = document.querySelectorAll('[data-anime="buttons"] a');
        buttons.forEach(button => {
          button.addEventListener('mouseenter', () => {
            anime({
              targets: button,
              scale: 1.05,
              duration: 200,
              easing: 'easeOutQuad'
            });
          });
          
          button.addEventListener('mouseleave', () => {
            anime({
              targets: button,
              scale: 1,
              duration: 200,
              easing: 'easeOutQuad'
            });
          });
        });
        
        // Status panel slide-in animation
        const p2pPanel = document.getElementById('p2p-panel');
        const wsStatus = document.getElementById('ws-status');
        
        anime({
          targets: p2pPanel,
          translateX: [-300, 0],
          opacity: [0, 1],
          duration: 800,
          delay: 1000,
          easing: 'easeOutExpo'
        });
        
        anime({
          targets: wsStatus,
          translateX: [300, 0],
          opacity: [0, 1],
          duration: 800,
          delay: 1200,
          easing: 'easeOutExpo'
        });
        
        // Status dot pulse animation
        const wsDot = document.getElementById('ws-dot');
        anime({
          targets: wsDot,
          scale: [1, 1.2, 1],
          duration: 2000,
          loop: true,
          easing: 'easeInOutQuad',
          delay: 2000
        });
        
        // Add floating background elements
        createFloatingElements();
      });
      
      // Create floating background elements
      function createFloatingElements() {
        const body = document.body;
        const colors = ['#667eea', '#764ba2', '#ffd700'];
        
        for (let i = 0; i < 8; i++) {
          const element = document.createElement('div');
          element.className = 'fixed pointer-events-none rounded-full opacity-10';
          element.style.width = Math.random() * 100 + 20 + 'px';
          element.style.height = element.style.width;
          element.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          element.style.left = Math.random() * 100 + '%';
          element.style.top = Math.random() * 100 + '%';
          
          body.appendChild(element);
          
          // Animate floating elements
          anime({
            targets: element,
            translateX: () => anime.random(-50, 50),
            translateY: () => anime.random(-50, 50),
            scale: [0.8, 1.2, 0.8],
            duration: 4000 + Math.random() * 4000,
            loop: true,
            easing: 'easeInOutQuad',
            delay: Math.random() * 2000
          });
        }
      }
      
      PKC.load('/modules.json');
    </script>
</body>
</html>