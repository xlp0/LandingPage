# Println Demo - IO Monad Modes
#
# Represents a "println" function using the Identity lambda (λx.x).
# Demonstrates controlling IO verbosity via the `io_effects` configuration.

version: '1.1'

chapter:
  id: 003
  title: 'Println Demo'
  mvp_card: 'The Printer'
  pkc_task: 'Control IO Verbosity'

clm:
  abstract_spec:
    context: "We need to output text to the console."
    goal: "Simulate println using Identity and IO effects."
    success_criteria: "Strings are returned correctly, with different logging levels."

  concrete_impl:
    runtime: lambda
    process: normalize
    io_effects:
      enabled: true      # Default: enabled
      console: true
      on_step: true      # Show reduction steps
      format: verbose    # Default: verbose output
    description: |
      PRINTLN = λx.x (Identity)
      
      We use the IO Monad config to control output:
      - Verbose: Shows full box-drawing step trace.
      - Minimal: Shows single-line summary.
      - Disabled: Silent execution.

  balanced_exp:
    expectation: "The string is returned unchanged."
    test_cases:
      # Case 1: Verbose Mode (Default)
      # Prints large box with "Step 1: ..."
      - given: "Verbose Print (Boxed Output)"
        when:
          io_effects:
            format: verbose
          arguments:
            expression: "(\\x.x) \"This is a rather long string to demonstrate the verbose printing capabilities of the IO Monad.\""
        then:
          result_contains: "rather long string"

      # Case 2: Minimal Mode
      # Prints single line: [IO:step 1] "..."
      - given: "Minimal Print (One Line)"
        when:
          io_effects:
            format: minimal
          arguments:
            expression: "(\\x.x) \"A shorter string for minimal output.\""
        then:
          result_contains: "shorter string"

      # Case 3: Silent Mode (Off)
      # No console output
      - given: "Silent Mode (No Output)"
        when:
          io_effects:
            enabled: false
          arguments:
            expression: "(\\x.x) \"You should not see this string in the console logs.\""
        then:
          result_contains: "not see this string"

examples:
  - name: "Verbose Println"
    description: "Full trace with heavy formatting"
    input:
      io_effects: { format: verbose }
      expression: "(\\x.x) \"Hello Verbose World!\""
    result_contains: "Hello Verbose World!"
