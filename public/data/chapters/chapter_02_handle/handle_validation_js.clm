version: '1.0'
chapter:
  id: 203
  title: 'Content Handle: The Validator PCard (JS)'
  mvp_card: The Gatekeeper (JS)
  pkc_task: Enforce Handle Syntax Rules via Javascript
  description: 'This PCard demonstrates handle string validation in JavaScript.
    '
clm:
  abstract:
    concept: Defensive Admission Control
    description: 'The Principle: Only syntactically valid handles are admitted.
      '
    math_model: "Valid = {s \u2208 String | first(s) \u2208 Letter \u2227 rest(s)\
      \ \u2286 Letter \u222A Digit \u222A {_, -}}"
  concrete:
    manifestation: Handle Validation
    description: Validate handle strings using Unicode categories
    runtime: javascript
    operation: custom
    code_file: handle_logic.js
    implementation:
      inputs:
        context: dict
    input_type: mcard
    output_type: mcard
    process_type: custom
  balanced:
    expectation: Syntax Enforcement
    description: 'The Evidence: Valid handles are accepted; invalid handles raise
      errors.
      '
    rules:
    - rule: Must start with Unicode letter
      regex: ^[\p{L}]
      reason: Avoids conflicts with numeric identifiers
    - rule: Letters, digits, underscores, hyphens
      regex: '[\p{L}\p{N}_-]'
      reason: Maximum compatibility across systems
    - rule: Case-folded
      method: casefold()
      reason: Case-insensitive matching
    - rule: Max 255 characters
      max_length: 255
      reason: Extended limit for file path compatibility
    expected_results:
      success: true
examples:
- name: Simple lowercase
  handle: my_document
  expected_valid: true
  normalized: my_document
- name: With numbers
  handle: project_v2
  expected_valid: true
  normalized: project_v2
- name: Single letter
  handle: a
  expected_valid: true
  normalized: a
- name: Uppercase normalized
  handle: MyDocument
  expected_valid: true
  normalized: mydocument
- name: Starts with digit
  handle: 1document
  expected_valid: false
  error: Must start with a letter
- name: With hyphen
  handle: my-document
  expected_valid: true
  normalized: my-document
- name: Contains period
  handle: my.document
  expected_valid: true
  normalized: my.document
- name: Contains space
  handle: my document
  expected_valid: true
  normalized: my document
- name: Contains question mark
  handle: doc?query
  expected_valid: false
  error: Special characters are not allowed
- name: Contains slash
  handle: path/to/doc
  expected_valid: true
  normalized: path/to/doc
- name: Empty string
  handle: ''
  expected_valid: false
  error: Handle cannot be empty
- name: Too long (256 chars)
  handle: a_very_long_handle_name_that_exceeds_two_hundred_and_fifty_five_characters_limit_by_adding_many_more_words_here_to_make_it_longer_than_the_maximum_allowed_length_for_a_valid_handle_string_in_the_system_which_is_now_256_characters_instead_of_the_original_limit
  expected_valid: false
  error: Handle exceeds maximum length of 255 characters
